; SAGADrivers
; $VER: SAGADrivers 3.0 (16.01.2024)

(complete 0)
(set @app-name "SAGADrivers")
(set @default-dest "RAM:")
; Check for AROS...
(set #AROS
  (exists "LIBS:aros.library" (noreq))
)

(complete 3)
; And if true...
(if (= #AROS 1)
(

(complete 6)
; Die !
(exit "\nIt seems you are using AROS at the moment.\n\nInstaller script is provided for AmigaOS 3.x only.\n\nScript will now exit. ")

)
) ; End If
(complete 9)
; Welcome message...
(welcome "Welcome to the SAGA Drivers Package installer. This installer will guide you through the required steps to install drivers for your Vampire product.")

(complete 12)
; Copy most files
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "C:")
  (choices "C/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:Keymaps")
  (choices "Devs/Keymaps/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:Monitors")
  (choices "Devs/Monitors/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:AHI")
  (choices "Devs/AHI/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:AudioModes")
  (choices "Devs/AudioModes/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:Networks")
  (choices "Devs/Networks/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "DEVS:")
  (choices "Devs/sagasd.device")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "ENVARC:")
  (choices "ENVARC/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "L:")
  (choices "L/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "SYS:Storage")
  (choices "Storage/")
)
(copyfiles
  (prompt "We will now start by copying some files.")
  (help @copyfiles-help)
  (confirm "expert")
  (source "")
  (dest "SYS:System")
  (choices "System/")
)

(complete 15)
; Check for existence of old SAGA monitor file
(set #OLDSAGA
  (exists "DEVS:Monitors/SAGA" (noreq))
)

(complete 18)
; If yes, set OLDSAGA to 1
(if (= #OLDSAGA 1)
(

(complete 21)
; and move it to Storage
(rename "DEVS:Monitors/SAGA" "SYS:Storage/Monitors/SAGA"
  (prompt "")
  (help )
)

)
) ; End If
(complete 24)
; Check for for existence of old SAGA monitor icon file
(set #OLDSAGAICON
  (exists "DEVS:Monitors/SAGA.info" (noreq))
)

(complete 27)
; If yes, set OLDSAGAICON to 1
(if (= #OLDSAGAICON 1)
(

(complete 30)
; and move it to Storage
(rename "DEVS:Monitors/SAGA.info" "SYS:Storage/Monitors/SAGA.info"
  (prompt "")
  (help )
)

)
) ; End If
(complete 33)
; Check for existence of old saga.card
(set #SAGACARD
  (exists "LIBS:Picasso96/saga.card" (noreq))
)

(complete 36)
; If yes, set SAGACARD to 1
(if (= #SAGACARD 1)
(

(complete 39)
; and rename it to saga.card_old
(rename "LIBS:Picasso96/saga.card" "LIBS:Picasso96/saga.card_old"
  (prompt "")
  (help )
)

)
) ; End If
(complete 42)
; Check existence of vampiregfx.card
(set #OLDGFX
  (exists "LIBS:Picasso96/vampiregfx.card" (noreq))
)

(complete 45)
; If yes, set OLDGFX to 1
(if (= #OLDGFX 1)
(

(complete 48)
; Rename old driver
(rename "LIBS:Picasso96/vampiregfx.card" "LIBS:Picasso96/vampiregfx.card_old"
  (prompt "")
  (help )
)

)
) ; End If
(complete 52)
; Check for Picasso96Settings existence...
(set #P96FILE
  (exists "DEVS:Picasso96Settings" (noreq))
)

(complete 55)
; If yes, set P96FILE to 1
(if (= #P96FILE 1)
(

(complete 58)
; Rename old file to _old
(rename "DEVS:Picasso96Settings" "DEVS:Picasso96Settings_old"
  (prompt "")
  (help )
)

)
) ; End If
(complete 61)
; Ask user to choose between cores
(set CORE
  (askchoice
    (prompt "Choose driver version")
    (help @askchoice-help)
    (choices "V4" "V2")
    (default 0)
  )
)
(if (= CORE 0) (set #7649 1) (set #7649 0))
(if (= CORE 1) (set #GOLD212 1) (set #GOLD212 0))

(complete 64)
; If user select 7649 or newer
(if (= #7649 1)
(

(complete 67)
; Copy 7649 driver for V4
(copyfiles
  (source "Libs/Picasso96/vampiregfx.card")
  (dest "LIBS:Picasso96/")
  (newname "LIBS:Picasso96/vampiregfx.card")
  (prompt "")
  (help )
  (confirm "average")
)

(complete 70)
; Copy P96 settings for V4
(copyfiles
  (source "Devs/Picasso96Settings.V4")
  (dest "DEVS:")
  (newname "DEVS:Picasso96Settings")
  (prompt "")
  (help )
)

)
) ; End If

(complete 82)
; if user selects GOLD212
(if (= #GOLD212 1)
(

(complete 85)
; Copy GOLD212 driver
(copyfiles
  (source "Libs/Picasso96/vampiregfx.card")
  (dest "LIBS:Picasso96/")
  (newname "LIBS:Picasso96/vampiregfx.card")
  (prompt "")
  (help )
  (confirm "average")
)

(complete 88)
; Copy P96 settings for V2
(copyfiles
  (source "Devs/Picasso96Settings.V2")
  (dest "DEVS:")
  (newname "DEVS:Picasso96Settings")
  (prompt "")
  (help )
)

)
) ; End If

(complete 100)
; Tadaaa
(exit)

